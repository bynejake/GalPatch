#pragma once

#ifdef WINMM

#define WIN32_LEAN_AND_MEAN

#include <Windows.h>

#include "Core/Core.h"

class Hijacker final : Core
{
public:
    static void Hijack(LPCTSTR lpSrc);
    static void Release();

private:
    DECLARE_ORIGINAL_FUNC(CloseDriver)
    DECLARE_ORIGINAL_FUNC(DefDriverProc)
    DECLARE_ORIGINAL_FUNC(DriverCallback)
    DECLARE_ORIGINAL_FUNC(DrvGetModuleHandle)
    DECLARE_ORIGINAL_FUNC(GetDriverModuleHandle)
    DECLARE_ORIGINAL_FUNC(OpenDriver)
    DECLARE_ORIGINAL_FUNC(PlaySound)
    DECLARE_ORIGINAL_FUNC(PlaySoundA)
    DECLARE_ORIGINAL_FUNC(PlaySoundW)
    DECLARE_ORIGINAL_FUNC(SendDriverMessage)
    DECLARE_ORIGINAL_FUNC(WOWAppExit)
    DECLARE_ORIGINAL_FUNC(auxGetDevCapsA)
    DECLARE_ORIGINAL_FUNC(auxGetDevCapsW)
    DECLARE_ORIGINAL_FUNC(auxGetNumDevs)
    DECLARE_ORIGINAL_FUNC(auxGetVolume)
    DECLARE_ORIGINAL_FUNC(auxOutMessage)
    DECLARE_ORIGINAL_FUNC(auxSetVolume)
    DECLARE_ORIGINAL_FUNC(joyConfigChanged)
    DECLARE_ORIGINAL_FUNC(joyGetDevCapsA)
    DECLARE_ORIGINAL_FUNC(joyGetDevCapsW)
    DECLARE_ORIGINAL_FUNC(joyGetNumDevs)
    DECLARE_ORIGINAL_FUNC(joyGetPos)
    DECLARE_ORIGINAL_FUNC(joyGetPosEx)
    DECLARE_ORIGINAL_FUNC(joyGetThreshold)
    DECLARE_ORIGINAL_FUNC(joyReleaseCapture)
    DECLARE_ORIGINAL_FUNC(joySetCapture)
    DECLARE_ORIGINAL_FUNC(joySetThreshold)
    DECLARE_ORIGINAL_FUNC(mciDriverNotify)
    DECLARE_ORIGINAL_FUNC(mciDriverYield)
    DECLARE_ORIGINAL_FUNC(mciExecute)
    DECLARE_ORIGINAL_FUNC(mciFreeCommandResource)
    DECLARE_ORIGINAL_FUNC(mciGetCreatorTask)
    DECLARE_ORIGINAL_FUNC(mciGetDeviceIDA)
    DECLARE_ORIGINAL_FUNC(mciGetDeviceIDFromElementIDA)
    DECLARE_ORIGINAL_FUNC(mciGetDeviceIDFromElementIDW)
    DECLARE_ORIGINAL_FUNC(mciGetDeviceIDW)
    DECLARE_ORIGINAL_FUNC(mciGetDriverData)
    DECLARE_ORIGINAL_FUNC(mciGetErrorStringA)
    DECLARE_ORIGINAL_FUNC(mciGetErrorStringW)
    DECLARE_ORIGINAL_FUNC(mciGetYieldProc)
    DECLARE_ORIGINAL_FUNC(mciLoadCommandResource)
    DECLARE_ORIGINAL_FUNC(mciSendCommandA)
    DECLARE_ORIGINAL_FUNC(mciSendCommandW)
    DECLARE_ORIGINAL_FUNC(mciSendStringA)
    DECLARE_ORIGINAL_FUNC(mciSendStringW)
    DECLARE_ORIGINAL_FUNC(mciSetDriverData)
    DECLARE_ORIGINAL_FUNC(mciSetYieldProc)
    DECLARE_ORIGINAL_FUNC(midiConnect)
    DECLARE_ORIGINAL_FUNC(midiDisconnect)
    DECLARE_ORIGINAL_FUNC(midiInAddBuffer)
    DECLARE_ORIGINAL_FUNC(midiInClose)
    DECLARE_ORIGINAL_FUNC(midiInGetDevCapsA)
    DECLARE_ORIGINAL_FUNC(midiInGetDevCapsW)
    DECLARE_ORIGINAL_FUNC(midiInGetErrorTextA)
    DECLARE_ORIGINAL_FUNC(midiInGetErrorTextW)
    DECLARE_ORIGINAL_FUNC(midiInGetID)
    DECLARE_ORIGINAL_FUNC(midiInGetNumDevs)
    DECLARE_ORIGINAL_FUNC(midiInMessage)
    DECLARE_ORIGINAL_FUNC(midiInOpen)
    DECLARE_ORIGINAL_FUNC(midiInPrepareHeader)
    DECLARE_ORIGINAL_FUNC(midiInReset)
    DECLARE_ORIGINAL_FUNC(midiInStart)
    DECLARE_ORIGINAL_FUNC(midiInStop)
    DECLARE_ORIGINAL_FUNC(midiInUnprepareHeader)
    DECLARE_ORIGINAL_FUNC(midiOutCacheDrumPatches)
    DECLARE_ORIGINAL_FUNC(midiOutCachePatches)
    DECLARE_ORIGINAL_FUNC(midiOutClose)
    DECLARE_ORIGINAL_FUNC(midiOutGetDevCapsA)
    DECLARE_ORIGINAL_FUNC(midiOutGetDevCapsW)
    DECLARE_ORIGINAL_FUNC(midiOutGetErrorTextA)
    DECLARE_ORIGINAL_FUNC(midiOutGetErrorTextW)
    DECLARE_ORIGINAL_FUNC(midiOutGetID)
    DECLARE_ORIGINAL_FUNC(midiOutGetNumDevs)
    DECLARE_ORIGINAL_FUNC(midiOutGetVolume)
    DECLARE_ORIGINAL_FUNC(midiOutLongMsg)
    DECLARE_ORIGINAL_FUNC(midiOutMessage)
    DECLARE_ORIGINAL_FUNC(midiOutOpen)
    DECLARE_ORIGINAL_FUNC(midiOutPrepareHeader)
    DECLARE_ORIGINAL_FUNC(midiOutReset)
    DECLARE_ORIGINAL_FUNC(midiOutSetVolume)
    DECLARE_ORIGINAL_FUNC(midiOutShortMsg)
    DECLARE_ORIGINAL_FUNC(midiOutUnprepareHeader)
    DECLARE_ORIGINAL_FUNC(midiStreamClose)
    DECLARE_ORIGINAL_FUNC(midiStreamOpen)
    DECLARE_ORIGINAL_FUNC(midiStreamOut)
    DECLARE_ORIGINAL_FUNC(midiStreamPause)
    DECLARE_ORIGINAL_FUNC(midiStreamPosition)
    DECLARE_ORIGINAL_FUNC(midiStreamProperty)
    DECLARE_ORIGINAL_FUNC(midiStreamRestart)
    DECLARE_ORIGINAL_FUNC(midiStreamStop)
    DECLARE_ORIGINAL_FUNC(mixerClose)
    DECLARE_ORIGINAL_FUNC(mixerGetControlDetailsA)
    DECLARE_ORIGINAL_FUNC(mixerGetControlDetailsW)
    DECLARE_ORIGINAL_FUNC(mixerGetDevCapsA)
    DECLARE_ORIGINAL_FUNC(mixerGetDevCapsW)
    DECLARE_ORIGINAL_FUNC(mixerGetID)
    DECLARE_ORIGINAL_FUNC(mixerGetLineControlsA)
    DECLARE_ORIGINAL_FUNC(mixerGetLineControlsW)
    DECLARE_ORIGINAL_FUNC(mixerGetLineInfoA)
    DECLARE_ORIGINAL_FUNC(mixerGetLineInfoW)
    DECLARE_ORIGINAL_FUNC(mixerGetNumDevs)
    DECLARE_ORIGINAL_FUNC(mixerMessage)
    DECLARE_ORIGINAL_FUNC(mixerOpen)
    DECLARE_ORIGINAL_FUNC(mixerSetControlDetails)
    DECLARE_ORIGINAL_FUNC(mmDrvInstall)
    DECLARE_ORIGINAL_FUNC(mmGetCurrentTask)
    DECLARE_ORIGINAL_FUNC(mmTaskBlock)
    DECLARE_ORIGINAL_FUNC(mmTaskCreate)
    DECLARE_ORIGINAL_FUNC(mmTaskSignal)
    DECLARE_ORIGINAL_FUNC(mmTaskYield)
    DECLARE_ORIGINAL_FUNC(mmioAdvance)
    DECLARE_ORIGINAL_FUNC(mmioAscend)
    DECLARE_ORIGINAL_FUNC(mmioClose)
    DECLARE_ORIGINAL_FUNC(mmioCreateChunk)
    DECLARE_ORIGINAL_FUNC(mmioDescend)
    DECLARE_ORIGINAL_FUNC(mmioFlush)
    DECLARE_ORIGINAL_FUNC(mmioGetInfo)
    DECLARE_ORIGINAL_FUNC(mmioInstallIOProcA)
    DECLARE_ORIGINAL_FUNC(mmioInstallIOProcW)
    DECLARE_ORIGINAL_FUNC(mmioOpenA)
    DECLARE_ORIGINAL_FUNC(mmioOpenW)
    DECLARE_ORIGINAL_FUNC(mmioRead)
    DECLARE_ORIGINAL_FUNC(mmioRenameA)
    DECLARE_ORIGINAL_FUNC(mmioRenameW)
    DECLARE_ORIGINAL_FUNC(mmioSeek)
    DECLARE_ORIGINAL_FUNC(mmioSendMessage)
    DECLARE_ORIGINAL_FUNC(mmioSetBuffer)
    DECLARE_ORIGINAL_FUNC(mmioSetInfo)
    DECLARE_ORIGINAL_FUNC(mmioStringToFOURCCA)
    DECLARE_ORIGINAL_FUNC(mmioStringToFOURCCW)
    DECLARE_ORIGINAL_FUNC(mmioWrite)
    DECLARE_ORIGINAL_FUNC(mmsystemGetVersion)
    DECLARE_ORIGINAL_FUNC(sndPlaySoundA)
    DECLARE_ORIGINAL_FUNC(sndPlaySoundW)
    DECLARE_ORIGINAL_FUNC(timeBeginPeriod)
    DECLARE_ORIGINAL_FUNC(timeEndPeriod)
    DECLARE_ORIGINAL_FUNC(timeGetDevCaps)
    DECLARE_ORIGINAL_FUNC(timeGetSystemTime)
    DECLARE_ORIGINAL_FUNC(timeGetTime)
    DECLARE_ORIGINAL_FUNC(timeKillEvent)
    DECLARE_ORIGINAL_FUNC(timeSetEvent)
    DECLARE_ORIGINAL_FUNC(waveInAddBuffer)
    DECLARE_ORIGINAL_FUNC(waveInClose)
    DECLARE_ORIGINAL_FUNC(waveInGetDevCapsA)
    DECLARE_ORIGINAL_FUNC(waveInGetDevCapsW)
    DECLARE_ORIGINAL_FUNC(waveInGetErrorTextA)
    DECLARE_ORIGINAL_FUNC(waveInGetErrorTextW)
    DECLARE_ORIGINAL_FUNC(waveInGetID)
    DECLARE_ORIGINAL_FUNC(waveInGetNumDevs)
    DECLARE_ORIGINAL_FUNC(waveInGetPosition)
    DECLARE_ORIGINAL_FUNC(waveInMessage)
    DECLARE_ORIGINAL_FUNC(waveInOpen)
    DECLARE_ORIGINAL_FUNC(waveInPrepareHeader)
    DECLARE_ORIGINAL_FUNC(waveInReset)
    DECLARE_ORIGINAL_FUNC(waveInStart)
    DECLARE_ORIGINAL_FUNC(waveInStop)
    DECLARE_ORIGINAL_FUNC(waveInUnprepareHeader)
    DECLARE_ORIGINAL_FUNC(waveOutBreakLoop)
    DECLARE_ORIGINAL_FUNC(waveOutClose)
    DECLARE_ORIGINAL_FUNC(waveOutGetDevCapsA)
    DECLARE_ORIGINAL_FUNC(waveOutGetDevCapsW)
    DECLARE_ORIGINAL_FUNC(waveOutGetErrorTextA)
    DECLARE_ORIGINAL_FUNC(waveOutGetErrorTextW)
    DECLARE_ORIGINAL_FUNC(waveOutGetID)
    DECLARE_ORIGINAL_FUNC(waveOutGetNumDevs)
    DECLARE_ORIGINAL_FUNC(waveOutGetPitch)
    DECLARE_ORIGINAL_FUNC(waveOutGetPlaybackRate)
    DECLARE_ORIGINAL_FUNC(waveOutGetPosition)
    DECLARE_ORIGINAL_FUNC(waveOutGetVolume)
    DECLARE_ORIGINAL_FUNC(waveOutMessage)
    DECLARE_ORIGINAL_FUNC(waveOutOpen)
    DECLARE_ORIGINAL_FUNC(waveOutPause)
    DECLARE_ORIGINAL_FUNC(waveOutPrepareHeader)
    DECLARE_ORIGINAL_FUNC(waveOutReset)
    DECLARE_ORIGINAL_FUNC(waveOutRestart)
    DECLARE_ORIGINAL_FUNC(waveOutSetPitch)
    DECLARE_ORIGINAL_FUNC(waveOutSetPlaybackRate)
    DECLARE_ORIGINAL_FUNC(waveOutSetVolume)
    DECLARE_ORIGINAL_FUNC(waveOutUnprepareHeader)
    DECLARE_ORIGINAL_FUNC(waveOutWrite)
};

#endif
